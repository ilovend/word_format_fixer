
这份修订后的架构方案非常出色！它成功地从“系统思维”转向了**“工具思维”**，将核心价值从“功能堆砌”收敛到了**“规则确定性”**上。

为了配合这个架构，我为你整理了配套的《功能与 UI 设计规范》。这份规范将延续你的“规则中心”理念，确保前端界面只是规则引擎的“遥控器”，而不是业务逻辑的承载者。

---

# Word 格式修复工具：功能与 UI 设计规范

## 一、 设计哲学

* **透明性**：用户必须清楚地知道规则引擎“做了什么”以及“为什么这么做”。
* **原子化**：每一项 UI 操作必须对应一个或一组独立的 Rule。
* **低摩擦**：从打开文档到完成修复，路径必须尽可能短。

---

## 二、 核心功能模块设计

### 1. 预设管理 (Preset Manager)

这是用户的第一入口。用户不应该每次都勾选规则，而是选择“场景”。

* **标准场景**：如“学术论文格式”、“企业公文规范”、“竞标书标准”。
* **规则组合**：每个预设是一组 `rule_id` 的集合。
* **配置预览**：点击预设，右侧列表自动勾选对应的规则。

### 2. 规则配置列表 (Rule Inspector)

展示 `rules/` 目录下所有可用规则的控制台。

* **分类展示**：按目录结构分为“字体规则”、“段落规则”、“表格规则”等。
* **状态控制**：提供 `Enable/Disable` 开关。
* **参数微调**：如果某个规则（如 `LineSpacingRule`）允许参数，则在此处显示简单的输入框（如：行间距设定为 1.5）。

### 3. 执行与报告 (Runner & Reporter)

* **静默修复**：一键执行，不干扰用户。
* **差异对比**：修复完成后，告知用户修改了多少处错误（数据由 Python `reporter.py` 提供）。
* **日志溯源**：提供简单的文本日志，显示：`[Rule_ID] Applied to Paragraph 12: Changed font size 10 -> 12`。

---

## 三、 UI 界面布局方案

界面采用典型的**三段式布局**，保持工具的高效感。

| 区域 | 功能描述 | UI 元素 |
| --- | --- | --- |
| **左侧导航** | 任务中心与预设选择 | 预设列表（卡片式）、“添加新文件”按钮 |
| **中间主区** | 规则配置与实时状态 | 规则分类折叠面板（Accordion）、规则开关、参数输入 |
| **右侧/底部** | 修复进度与报告统计 | 进度条、修复成功数统计、导出按钮、日志控制台 |

---

## 四、 交互细节规范 (Interaction Specs)

### 4.1 文件处理流

1. **拖拽即识别**：支持将 .docx 文件直接拖入 Electron 窗口。
2. **前置校验**：Python 后端快速扫描文档结构，若文件加密或损坏，UI 立即反馈。
3. **原子化执行**：点击“开始修复”，前端通过 IPC 发送 `JSON` 配置，后端循环执行规则池。

### 4.2 规则交互状态

* **待命 (Idle)**：规则显示默认配置。
* **执行中 (Running)**：规则旁出现小转轮或进度指示。
* **完成 (Completed)**：显示修复的具体数量（如：`已修复 12 处`）。

---

## 五、 UI 视觉约束 (Visual Constraints)

为了符合“专业工具”的定位，避免过度的 UI 装饰：

* **配色方案**：以 **Microsoft Word 蓝色 (#2B579A)** 或 **中性深灰 (#333333)** 为主色调，强调生产力属性。
* **字体**：优先使用系统原生字体（如 Windows 下的微软雅黑），确保文字清晰。
* **图标**：仅在区分“字体”、“段落”、“表格”时使用简单的单色图标（推荐使用 `Lucide React` 库）。

---

## 六、 针对 AI 的开发指令 (Prompt 补充)

当你要求 AI 生成 UI 代码时，请附加以下约束：

```text
【UI 组件约束】
- 严禁在 React 组件中编写任何 Word 处理逻辑。
- 所有的规则展示必须根据后端返回的 rule_id 动态渲染。
- UI 状态必须与规则引擎的 RuleResult 结构强耦合。
- 必须包含一个“开发者模式”日志窗口，实时显示来自 IPC 的原始 JSON 数据。

