# Word格式修复工具独立EXE打包文档

## 一、打包方案

### 1. 技术栈
- 前端：Electron + HTML + CSS + JavaScript
- 后端：Python + FastAPI
- 打包工具：electron-builder + PyInstaller

### 2. 打包思路
- 使用PyInstaller将Python后端打包为可执行文件
- 使用electron-builder将Electron前端和Python后端一起打包为EXE安装包
- 安装包包含所有依赖，无需用户额外安装Python或其他组件

## 二、打包步骤

### 1. 打包Python后端

#### 1.1 安装PyInstaller
```bash
pip install pyinstaller
```

#### 1.2 打包命令
```bash
cd python-backend
pyinstaller --onefile --name=word_format_fixer_backend main.py
```

#### 1.3 打包结果
- 可执行文件将生成在`python-backend/dist/word_format_fixer_backend.exe`

### 2. 修改Electron主进程

#### 2.1 更新startPythonServer函数
```javascript
function startPythonServer() {
    console.log('Starting Python server...');
    pythonProcess = spawn(path.join(__dirname, 'resources', 'python-backend', 'word_format_fixer_backend.exe'), [], {
        cwd: path.join(__dirname, 'resources', 'python-backend'),
        stdio: 'inherit'
    });
}
```

### 3. 配置electron-builder

#### 3.1 更新package.json
```json
"build": {
    "appId": "com.wordformatfixer.app",
    "productName": "Word格式修复工具",
    "directories": {
        "output": "../build/electron"
    },
    "win": {
        "target": "nsis",
        "icon": "build/icon.ico"
    },
    "extraResources": [
        {
            "from": "../python-backend/dist/",
            "to": "python-backend",
            "filter": ["**/*"]
        }
    ]
}
```

### 4. 打包Electron应用

#### 4.1 安装依赖
```bash
cd electron
npm install
```

#### 4.2 打包命令
```bash
npm run build
```

#### 4.3 打包结果
- 安装包将生成在`build/electron/`目录下

## 三、测试与验证

### 1. 安装应用
- 双击生成的EXE安装包
- 按照安装向导完成安装

### 2. 验证功能
- 启动应用
- 选择Word文档进行处理
- 验证文档处理结果
- 检查是否有报错

## 四、常见问题及解决方案

### 1. Python后端无法启动
- 检查路径设置是否正确
- 检查PyInstaller打包是否包含所有依赖
- 检查防火墙和杀毒软件设置

### 2. 前后端通信失败
- 检查端口配置
- 检查Python后端是否正常运行
- 检查网络设置

### 3. 安装包体积过大
- 优化PyInstaller打包选项
- 移除不必要的依赖
- 使用UPX等工具压缩

## 五、优化建议

### 1. 用户体验优化
- 添加安装进度显示
- 添加桌面快捷方式
- 优化卸载流程

### 2. 性能优化
- 优化Python后端启动速度
- 优化Electron应用启动速度
- 优化文档处理算法

### 3. 安全性优化
- 代码签名
- 防止逆向工程
- 加密敏感数据
