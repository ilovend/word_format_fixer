<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word格式修复工具</title>
    <link rel="stylesheet" href="css/form-generator.css">
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <div class="container">
        <!-- 左侧导航 - 预设管理 -->
        <div class="left-panel">
            <h2>预设管理</h2>

            <div class="preset-section">
                <div class="preset-controls">
                    <button class="btn btn-primary" onclick="openPresetEditor()">新建预设</button>
                </div>
                <h3>标准场景</h3>
                <div class="preset-cards">
                    <div class="preset-card active" data-preset="default">
                        <div class="preset-header">
                            <h4>默认配置</h4>
                            <div class="preset-actions">
                                <button class="btn btn-sm btn-secondary"
                                    onclick="openPresetEditor('default')">编辑</button>
                                <button class="btn btn-sm btn-danger"
                                    onclick="confirmDeletePreset('default')">删除</button>
                            </div>
                        </div>
                        <p>包含所有常用规则的标准配置</p>
                    </div>
                    <div class="preset-card" data-preset="minimal">
                        <div class="preset-header">
                            <h4>最小配置</h4>
                            <div class="preset-actions">
                                <button class="btn btn-sm btn-secondary"
                                    onclick="openPresetEditor('minimal')">编辑</button>
                                <button class="btn btn-sm btn-danger"
                                    onclick="confirmDeletePreset('minimal')">删除</button>
                            </div>
                        </div>
                        <p>仅包含必要规则</p>
                    </div>
                    <div class="preset-card" data-preset="comprehensive">
                        <div class="preset-header">
                            <h4>全面配置</h4>
                            <div class="preset-actions">
                                <button class="btn btn-sm btn-secondary"
                                    onclick="openPresetEditor('comprehensive')">编辑</button>
                                <button class="btn btn-sm btn-danger"
                                    onclick="confirmDeletePreset('comprehensive')">删除</button>
                            </div>
                        </div>
                        <p>包含所有规则</p>
                    </div>
                    <div class="preset-card" data-preset="academic">
                        <div class="preset-header">
                            <h4>学术论文格式</h4>
                            <div class="preset-actions">
                                <button class="btn btn-sm btn-secondary"
                                    onclick="openPresetEditor('academic')">编辑</button>
                                <button class="btn btn-sm btn-danger"
                                    onclick="confirmDeletePreset('academic')">删除</button>
                            </div>
                        </div>
                        <p>符合学术论文的格式规范</p>
                    </div>
                    <div class="preset-card" data-preset="business">
                        <div class="preset-header">
                            <h4>企业公文规范</h4>
                            <div class="preset-actions">
                                <button class="btn btn-sm btn-secondary"
                                    onclick="openPresetEditor('business')">编辑</button>
                                <button class="btn btn-sm btn-danger"
                                    onclick="confirmDeletePreset('business')">删除</button>
                            </div>
                        </div>
                        <p>适合企业正式文档</p>
                    </div>
                    <div class="preset-card" data-preset="bid">
                        <div class="preset-header">
                            <h4>竞标书标准</h4>
                            <div class="preset-actions">
                                <button class="btn btn-sm btn-secondary" onclick="openPresetEditor('bid')">编辑</button>
                                <button class="btn btn-sm btn-danger" onclick="confirmDeletePreset('bid')">删除</button>
                            </div>
                        </div>
                        <p>专业竞标文档格式</p>
                    </div>
                </div>
            </div>

            <div class="file-section">
                <h3>文件操作</h3>
                <div class="file-buttons">
                    <button class="btn btn-primary" id="selectFile">选择Word文档</button>
                    <button class="btn btn-secondary" id="clearFile">清除选择</button>
                </div>

                <div class="drop-zone" id="dropZone">
                    <h3>拖拽文件到此处</h3>
                    <p>或点击上方按钮选择文件</p>
                </div>
            </div>

            <div class="file-section">
                <h3>配置管理</h3>
                <div class="file-buttons">
                    <button class="btn btn-primary" id="saveConfig">保存当前配置</button>
                    <button class="btn btn-secondary" id="loadConfig">加载配置</button>
                    <button class="btn btn-secondary" id="exportConfig">导出配置</button>
                    <button class="btn btn-secondary" id="importConfig">导入配置</button>
                </div>
            </div>
        </div>

        <!-- 中间主区 - 规则配置 -->
        <div class="main-panel">
            <h2>规则配置</h2>

            <!-- 规则分类将由JavaScript动态生成 -->
        </div>

        <!-- 右侧面板 - 执行与报告 -->
        <div class="right-panel">
            <!-- 文件信息 -->
            <div class="file-info-section">
                <h2>文件信息</h2>
                <div class="file-path" id="filePath">未选择文件</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="totalRules">0</div>
                        <div class="stat-label">总规则数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="enabledRules">0</div>
                        <div class="stat-label">启用规则</div>
                    </div>
                </div>
            </div>

            <!-- 执行控制 -->
            <div class="execute-section">
                <button class="execute-btn" id="processFile" disabled>处理文档</button>
                <div class="progress-bar" style="display: none;">
                    <div class="progress-fill" style="width: 0%"></div>
                </div>
            </div>

            <!-- 报告与状态 -->
            <div class="report-section">
                <h2>执行报告</h2>
                <div class="status-indicator" id="status"></div>
                <div class="report-details" id="result"></div>

                <!-- 开发者模式日志窗口 -->
                <div class="developer-log">
                    <h4>开发者日志</h4>
                    <pre id="devLog">等待操作...</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- 动态表单生成器 -->
    <script src="js/form-generator.js"></script>

    <!-- 应用主逻辑 -->
    <script src="js/renderer.js"></script>

    <!-- 预设编辑器模态框 -->
    <div id="presetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">预设编辑器</h2>
                <span class="close" onclick="closePresetEditor()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="presetName">预设名称</label>
                    <input type="text" id="presetName" placeholder="请输入预设名称">
                </div>
                <div class="form-group">
                    <label for="presetDescription">预设描述</label>
                    <textarea id="presetDescription" placeholder="请输入预设描述"></textarea>
                </div>
                <div id="ruleSelection" class="rule-selection">
                    <!-- 规则选择列表将由JavaScript动态生成 -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closePresetEditor()">取消</button>
                <button class="btn btn-primary" id="savePreset">保存</button>
            </div>
        </div>
    </div>
</body>

</html>